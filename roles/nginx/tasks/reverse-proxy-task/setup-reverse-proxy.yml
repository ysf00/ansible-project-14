---
# notify the restart handler after this!!
- name: configure nginx reverse proxy
  ansible.builtin.template:
    src: ../../templates/reverseproxy.j2
    dest: /etc/nginx/conf.d/reverseproxy.conf
    owner: root
    group: root
    mode: '0644'
  notify: (Handler) Restart Nginx

# static setup, change to dynamic
# - name: add mappings to /etc/hosts
#   blockinfile:
#     path: /etc/hosts
#     block: |
#       {{ item.ip }} {{ item.name }}
#     marker: "# DO NOT EDIT, ANSIBLE MANAGED BLOCK {{ item.name }}"
#   loop:
#     - { name: "{{ host_1 }}", ip: 172.31.32.11 }
#     - { name: "{{ host_2 }}", ip: 172.31.32.12 }
#     - { name: "{{ host_3 }}", ip: 172.31.32.13 }
